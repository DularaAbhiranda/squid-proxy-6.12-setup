Install Squid on CentOS Stream 9
 
 
1Ô∏è‚É£ Check what version is in default repo
dnf info squid
 
2Ô∏è‚É£ Install Squid
sudo dnf install squid -y
 
3Ô∏è‚É£ Enable and start service
sudo systemctl enable --now squid
 
4Ô∏è‚É£ Verify version
squid --version
 
 
 
Build Squid 6.12 from source (latest stable)
# Install dependencies
sudo dnf groupinstall "Development Tools" -y
sudo dnf install gcc gcc-c++ make openssl-devel pam-devel libcap-devel libuuid-devel libdb-devel wget tar -y
 
# Download latest 6.12
wget http://www.squid-cache.org/Versions/v6/squid-6.12.tar.gz
tar -xvzf squid-6.12.tar.gz
cd squid-6.12
 
# Configure & build
./configure --prefix=/usr --sysconfdir=/etc/squid --with-openssl --enable-ssl --enable-ssl-crtd
make -j$(nproc)
sudo make install
 
# Initialize cache
sudo squid -z
 
# Start Squid
sudo systemctl enable --now squid
 
 
 
üî¥üî¥Important Partüî¥üî¥
 
edit /etc/squid/squid.conf
 
 
sudo nano /etc/squid/squid.conf
 
 
 
 
# =========================
# Squid 6.12 Config
# =========================
 
# Run Squid as this user/group
cache_effective_user squid
cache_effective_group squid
 
# Ports
http_port 3128
 
# Cache directories
cache_dir ufs /var/cache/squid 100 16 256
coredump_dir /var/cache/squid
 
# Logging
cache_log /var/log/squid/cache.log
access_log /var/log/squid/access.log
cache_store_log /var/log/squid/store.log
 
# PID file
pid_filename /var/run/squid/squid.pid
 
# ACLs - local networks
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16
acl localnet src 127.0.0.1/32       # localhost
 
# Ports allowed
acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 1025-65535  # unregistered ports
 
# Access rules
http_access allow localhost
http_access allow localnet
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access deny all
 
# Refresh patterns (caching rules)
refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320
 
 
 
------------------------------------- end --------------------------
 
sudo squid -z
 
 
 
sudo systemctl start squid
 
 
sudo systemctl status squid
 
 
sudo netstat -tulnp | grep 3128
 
 
ss -tulnp | grep 3128
 
 
tail -f /var/log/squid/cache.log
 
